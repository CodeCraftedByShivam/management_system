{% extends 'base.html' %}

{% block title %}{{ student.full_name }} - Student Details{% endblock %}

{% block content %}
<div class="breadcrumb">
    <a href="{% url 'dashboard' %}">Dashboard</a> / 
    <a href="{% url 'student_list' %}">Students</a> / 
    <span>{{ student.full_name }}</span>
</div>

<!-- Student Profile Header -->
<div class="profile-header">
    <div class="profile-avatar-large">
        {% if student.profile_image %}
            <img src="{{ student.profile_image.url }}" alt="{{ student.full_name }}">
        {% else %}
            <div class="avatar-placeholder-large">{{ student.first_name.0 }}{{ student.last_name.0 }}</div>
        {% endif %}
    </div>
    <div class="profile-info">
        <h1>{{ student.full_name }}</h1>
        <p class="profile-meta">
            <span class="meta-item">🆔 {{ student.student_id }}</span>
            <span class="meta-item">📧 {{ student.email }}</span>
            <span class="meta-item">📱 {{ student.phone }}</span>
        </p>
        <div class="profile-badges">
            <span class="status-badge status-{{ student.status|lower }}">{{ student.status }}</span>
            <span class="info-badge">🎂 {{ student.age }} years old</span>
            <span class="info-badge">📍 {{ student.city }}, {{ student.state }}</span>
        </div>
    </div>
    <div class="profile-actions">
        <a href="{% url 'student_update' student.pk %}" class="btn btn-primary">✏️ Edit Profile</a>
        <a href="{% url 'student_delete' student.pk %}" class="btn btn-danger">🗑️ Delete</a>
    </div>
</div>

<!-- Statistics Cards -->
<!-- Statistics Cards -->
<div class="detail-stats-grid">
    <div class="detail-stat-card stat-card-1">
        <div class="stat-icon">📚</div>
        <div class="stat-value">{{ total_courses }}</div>
        <div class="stat-label">Total Courses</div>
        <div class="stat-mini-progress">
            <div class="mini-fill" data-width="80"></div>
        </div>
    </div>
    <div class="detail-stat-card stat-card-2">
        <div class="stat-icon">✅</div>
        <div class="stat-value">{{ active_courses }}</div>
        <div class="stat-label">Active Courses</div>
        <div class="stat-mini-progress">
            <div class="mini-fill" data-width="90"></div>
        </div>
    </div>
    <div class="detail-stat-card stat-card-3">
        <div class="stat-icon">🎓</div>
        <div class="stat-value">{{ completed_courses }}</div>
        <div class="stat-label">Completed</div>
        <div class="stat-mini-progress">
            <div class="mini-fill" data-width="70"></div>
        </div>
    </div>
    <div class="detail-stat-card stat-card-4">
        <div class="stat-icon">📊</div>
        <div class="stat-value">{{ attendance_percentage }}%</div>
        <div class="stat-label">Attendance</div>
        <div class="stat-mini-progress">
            <div class="mini-fill" data-width="{{ attendance_percentage }}"></div>
        </div>
    </div>
</div>

<!-- Main Content -->
<div class="detail-content-grid">
    <!-- Personal Information -->
    <div class="detail-section">
        <h2>👤 Personal Information</h2>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Full Name</span>
                <span class="info-value">{{ student.full_name }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Email</span>
                <span class="info-value">{{ student.email }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Phone</span>
                <span class="info-value">{{ student.phone }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Date of Birth</span>
                <span class="info-value">{{ student.date_of_birth|date:"F d, Y" }} ({{ student.age }} years)</span>
            </div>
            <div class="info-item">
                <span class="info-label">Gender</span>
                <span class="info-value">{{ student.get_gender_display }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Blood Group</span>
                <span class="info-value">{{ student.blood_group|default:"Not specified" }}</span>
            </div>
        </div>
    </div>
    
    <!-- Address Information -->
    <div class="detail-section">
        <h2>📍 Address Information</h2>
        <div class="info-grid">
            <div class="info-item full-width">
                <span class="info-label">Street Address</span>
                <span class="info-value">{{ student.address }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">City</span>
                <span class="info-value">{{ student.city }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">State</span>
                <span class="info-value">{{ student.state }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Postal Code</span>
                <span class="info-value">{{ student.postal_code }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Country</span>
                <span class="info-value">{{ student.country }}</span>
            </div>
        </div>
    </div>
    
    <!-- Emergency Contact -->
    <div class="detail-section">
        <h2>🚨 Emergency Contact</h2>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Parent/Guardian</span>
                <span class="info-value">{{ student.parent_name|default:"Not specified" }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Parent Phone</span>
                <span class="info-value">{{ student.parent_phone|default:"Not specified" }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Emergency Contact</span>
                <span class="info-value">{{ student.emergency_contact|default:"Not specified" }}</span>
            </div>
        </div>
    </div>
    
    <!-- Academic Information -->
    <div class="detail-section">
        <h2>🎓 Academic Information</h2>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Student ID</span>
                <span class="info-value student-id">{{ student.student_id }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Status</span>
                <span class="status-badge status-{{ student.status|lower }}">{{ student.status }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Enrollment Date</span>
                <span class="info-value">{{ student.enrollment_date|date:"F d, Y" }}</span>
            </div>
        </div>
    </div>
</div>

<!-- Enrolled Courses -->
<div class="detail-section full-width">
    <div class="section-header">
        <h2>📚 Enrolled Courses</h2>
        <span class="count-badge">{{ enrollments.count }} Course{{ enrollments.count|pluralize }}</span>
    </div>
    {% if enrollments %}
        <div class="courses-grid">
            {% for enrollment in enrollments %}
            <div class="course-card">
                <div class="course-header">
                    <h3>{{ enrollment.course.course_name }}</h3>
                    <span class="course-badge status-{{ enrollment.status|lower }}">{{ enrollment.status }}</span>
                </div>
                <div class="course-details">
                    <div class="course-detail-item">
                        <span class="detail-icon">🔖</span>
                        <span>{{ enrollment.course.course_code }}</span>
                    </div>
                    <div class="course-detail-item">
                        <span class="detail-icon">👨‍🏫</span>
                        <span>{{ enrollment.course.instructor }}</span>
                    </div>
                    <div class="course-detail-item">
                        <span class="detail-icon">⭐</span>
                        <span>{{ enrollment.course.credits }} Credits</span>
                    </div>
                    <div class="course-detail-item">
                        <span class="detail-icon">📅</span>
                        <span>Enrolled: {{ enrollment.enrollment_date|date:"M d, Y" }}</span>
                    </div>
                </div>
                {% if enrollment.average_grade %}
                <div class="course-grade">
                    <span class="grade-label">Average Grade:</span>
                    <span class="grade-value">{{ enrollment.average_grade }}%</span>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <span class="empty-icon">📚</span>
            <p>No courses enrolled yet</p>
        </div>
    {% endif %}
</div>

<!-- Recent Grades -->
<!-- Recent Grades -->
{% if recent_grades %}
<div class="detail-section full-width">
    <div class="section-header">
        <h2>📊 Recent Grades</h2>
    </div>
    <div class="grades-table">
        <table>
            <thead>
                <tr>
                    <th>Assignment</th>
                    <th>Course</th>
                    <th>Marks</th>
                    <th>Percentage</th>
                    <th>Grade</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for grade in recent_grades %}
                <tr>
                    <td>{{ grade.assignment_name }}</td>
                    <td>{{ grade.enrollment.course.course_name }}</td>
                    <td>{{ grade.marks_obtained }}/{{ grade.total_marks }}</td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar-small">
                                <div class="progress-fill-small" data-width="{{ grade.percentage }}"></div>
                            </div>
                            <span class="percentage-text">{{ grade.percentage }}%</span>
                        </div>
                    </td>
                    <td><span class="grade-letter">{{ grade.grade_letter }}</span></td>
                    <td>{{ grade.date|date:"M d, Y" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
// Set progress bar widths using JavaScript
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.progress-fill-small').forEach(function(bar) {
        const width = bar.getAttribute('data-width');
        bar.style.width = width + '%';
    });
});
</script>
{% endif %}




<script>
// Set progress bar widths using JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Set mini progress bars
    document.querySelectorAll('.mini-fill').forEach(function(bar) {
        const width = bar.getAttribute('data-width');
        bar.style.width = width + '%';
    });
    
    // Set grades progress bars
    document.querySelectorAll('.progress-fill-small').forEach(function(bar) {
        const width = bar.getAttribute('data-width');
        bar.style.width = width + '%';
    });
});
</script>


<style>
.breadcrumb {
    margin-bottom: 30px;
    color: #b0b0b0;
    font-size: 14px;
}

.breadcrumb a {
    color: #7877c6;
    text-decoration: none;
    transition: color 0.3s;
}

.breadcrumb a:hover {
    color: #4ecdc4;
}

.profile-header {
    background: rgba(44, 62, 80, 0.3);
    border: 2px solid rgba(120, 119, 198, 0.3);
    border-radius: 20px;
    padding: 40px;
    display: flex;
    gap: 30px;
    align-items: center;
    margin-bottom: 30px;
    transition: all 0.3s ease;
}

.profile-header:hover {
    border-color: #7877c6;
    box-shadow: 0 12px 35px rgba(120, 119, 198, 0.3);
}

.profile-avatar-large {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    overflow: hidden;
    border: 5px solid #7877c6;
    box-shadow: 0 10px 30px rgba(120, 119, 198, 0.4);
    flex-shrink: 0;
}

.profile-avatar-large img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.avatar-placeholder-large {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #7877c6, #4ecdc4);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 56px;
    font-weight: 700;
    color: #fff;
}

.profile-info {
    flex: 1;
}

.profile-info h1 {
    font-size: 36px;
    margin-bottom: 15px;
    background: linear-gradient(135deg, #fff 0%, #7877c6 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.profile-meta {
    display: flex;
    gap: 20px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.meta-item {
    color: #b0b0b0;
    font-size: 14px;
}

.profile-badges {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.info-badge {
    padding: 8px 16px;
    background: rgba(120, 119, 198, 0.2);
    border-radius: 20px;
    font-size: 14px;
    color: #e0e0e0;
    border: 1px solid rgba(120, 119, 198, 0.3);
}

.profile-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.detail-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.detail-stat-card {
    background: rgba(44, 62, 80, 0.3);
    border: 2px solid rgba(120, 119, 198, 0.3);
    border-radius: 15px;
    padding: 30px;
    text-align: center;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.detail-stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    transition: width 0.3s ease;
}

.stat-card-1::before {
    background: linear-gradient(135deg, #7877c6, #5e548e);
}

.stat-card-2::before {
    background: linear-gradient(135deg, #4ecdc4, #44a08d);
}

.stat-card-3::before {
    background: linear-gradient(135deg, #feca57, #ff9ff3);
}

.stat-card-4::before {
    background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
}

.detail-stat-card:hover {
    transform: translateY(-8px);
    border-color: #7877c6;
    box-shadow: 0 15px 40px rgba(120, 119, 198, 0.4);
}

.detail-stat-card:hover::before {
    width: 100%;
    opacity: 0.1;
}

.stat-icon {
    font-size: 36px;
    margin-bottom: 15px;
    filter: drop-shadow(0 4px 10px rgba(0, 0, 0, 0.3));
}

.stat-value {
    font-size: 48px;
    font-weight: 700;
    background: linear-gradient(135deg, #fff 0%, #7877c6 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 10px;
}

.stat-label {
    color: #b0b0b0;
    font-size: 16px;
    margin-bottom: 15px;
}

.stat-mini-progress {
    width: 100%;
    height: 4px;
    background: rgba(44, 62, 80, 0.5);
    border-radius: 10px;
    overflow: hidden;
}

.mini-fill {
    height: 100%;
    background: linear-gradient(90deg, #7877c6, #4ecdc4);
    border-radius: 10px;
    transition: width 1s ease;
}

.detail-content-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

.detail-section {
    background: rgba(44, 62, 80, 0.3);
    border: 2px solid rgba(120, 119, 198, 0.3);
    border-radius: 15px;
    padding: 30px;
    transition: all 0.3s ease;
}

.detail-section:hover {
    border-color: rgba(120, 119, 198, 0.5);
}

.detail-section h2 {
    font-size: 20px;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid rgba(120, 119, 198, 0.2);
    color: #fff;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.info-item.full-width {
    grid-column: 1 / -1;
}

.info-label {
    font-size: 13px;
    color: #7877c6;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.info-value {
    font-size: 16px;
    color: #e0e0e0;
}

.student-id {
    padding: 6px 12px;
    background: rgba(120, 119, 198, 0.2);
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    font-weight: 600;
    color: #7877c6;
    display: inline-block;
}

.full-width {
    grid-column: 1 / -1;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid rgba(120, 119, 198, 0.2);
}

.section-header h2 {
    margin: 0;
    padding: 0;
    border: none;
}

.count-badge {
    padding: 6px 14px;
    background: rgba(120, 119, 198, 0.2);
    border-radius: 20px;
    font-size: 14px;
    color: #7877c6;
    font-weight: 600;
}

.courses-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.course-card {
    background: rgba(26, 26, 46, 0.5);
    border: 2px solid rgba(120, 119, 198, 0.2);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.3s ease;
}

.course-card:hover {
    border-color: #7877c6;
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(120, 119, 198, 0.3);
}

.course-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 15px;
    gap: 10px;
}

.course-header h3 {
    font-size: 18px;
    color: #fff;
    flex: 1;
    margin: 0;
}

.course-badge {
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    flex-shrink: 0;
}

.status-active {
    background: rgba(78, 205, 196, 0.2);
    color: #4ecdc4;
    border: 1px solid #4ecdc4;
}

.status-inactive {
    background: rgba(255, 107, 107, 0.2);
    color: #ff6b6b;
    border: 1px solid #ff6b6b;
}

.status-completed {
    background: rgba(254, 202, 87, 0.2);
    color: #feca57;
    border: 1px solid #feca57;
}

.status-graduated {
    background: rgba(254, 202, 87, 0.2);
    color: #feca57;
    border: 1px solid #feca57;
}

.status-suspended {
    background: rgba(150, 150, 150, 0.2);
    color: #999;
    border: 1px solid #999;
}

.course-details {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 15px;
}

.course-detail-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    color: #b0b0b0;
}

.detail-icon {
    font-size: 16px;
}

.course-grade {
    padding-top: 15px;
    border-top: 1px solid rgba(120, 119, 198, 0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.grade-label {
    font-size: 13px;
    color: #b0b0b0;
}

.grade-value {
    font-size: 20px;
    font-weight: 700;
    color: #4ecdc4;
}

.grades-table {
    overflow-x: auto;
}

.grades-table table {
    width: 100%;
    border-spacing: 0;
}

.grades-table th {
    background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    color: #fff;
    padding: 15px;
    text-align: left;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 13px;
    letter-spacing: 0.5px;
}

.grades-table tbody tr {
    background: rgba(26, 26, 46, 0.5);
    border-bottom: 1px solid rgba(120, 119, 198, 0.1);
    transition: all 0.3s ease;
}

.grades-table tbody tr:hover {
    background: rgba(120, 119, 198, 0.15);
}

.grades-table td {
    padding: 15px;
    color: #e0e0e0;
}

.progress-container {
    display: flex;
    align-items: center;
    gap: 10px;
}

.progress-bar-small {
    width: 100px;
    height: 6px;
    background: rgba(44, 62, 80, 0.5);
    border-radius: 10px;
    overflow: hidden;
}

.progress-fill-small {
    height: 100%;
    background: linear-gradient(90deg, #7877c6, #4ecdc4);
    border-radius: 10px;
    transition: width 0.5s ease;
}

.percentage-text {
    font-size: 13px;
    color: #7877c6;
    font-weight: 600;
    min-width: 45px;
}

.grade-letter {
    padding: 6px 12px;
    background: rgba(78, 205, 196, 0.2);
    border-radius: 8px;
    font-weight: 700;
    color: #4ecdc4;
    display: inline-block;
}

.empty-state {
    text-align: center;
    padding: 50px 20px;
    color: #b0b0b0;
}

.empty-icon {
    font-size: 56px;
    display: block;
    margin-bottom: 15px;
    opacity: 0.5;
}

@media (max-width: 768px) {
    .profile-header {
        flex-direction: column;
        text-align: center;
    }
    
    .profile-actions {
        width: 100%;
    }
    
    .detail-content-grid {
        grid-template-columns: 1fr;
    }
    
    .courses-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
